<!-- path-sync copy -n sdlc -->
# Contributing Documentation

Guide for documentation contributors working on this Terraform module.

## Overview

This module uses automated documentation generation to keep documentation in sync with Terraform source code. Understanding which content is generated versus hand-maintained helps you propose changes effectively.

## Generated vs Hand-Maintained Content

### Generated Content (Do Not Edit Directly)

These files and sections are automatically generated and will be overwritten:

- **Root README.md sections**:
  - Table of Contents (between `<!-- BEGIN_TOC -->` and `<!-- END_TOC -->`)
  - Example tables (between `<!-- BEGIN_TABLES -->` and `<!-- END_TABLES -->`)
  - Requirements, Providers, Resources, Variables, Outputs (between `<!-- BEGIN_TF_DOCS -->` and `<!-- END_TF_DOCS -->`)
- **Example README.md files** (`examples/*/README.md`): Entire files are generated from templates

### Hand-Maintained Content

These sections can be edited directly:

- Root README.md content outside generated markers
- Documentation templates (`docs/example_readme.md`)
- Configuration files (`.terraform-docs.yml`, `docs/examples.yaml`, `docs/inputs_groups.yaml`)
- Variable descriptions in `variable_*.tf` files

## How to Propose Changes to Generated Content

### Updating Variable Documentation

Variable descriptions come from `variable_*.tf` files. To update variable documentation:

1. Edit the `description` field in the relevant `variable_*.tf` file
2. Run `just docs` to regenerate documentation
3. Review changes and commit

Example:

```hcl
variable "instance_size" {
  description = "Tier for each data-bearing server in the cluster. Choose from M0, M2, M5, M10, M20, M30, M40, M50, M60, M80, M140, M200, M300, M400, M700, or M1000."
  type        = string
}
```

### Changing Inputs Section Grouping

The **grouped Inputs section** organizes module variables into logical categories (e.g., "Required Variables", "Auto Scaling", "Production Recommendations") instead of a single alphabetical list. This makes the README easier to navigate for users. The grouping configuration is in `docs/inputs_groups.yaml`.

To change how variables are grouped:

1. Edit `docs/inputs_groups.yaml`
2. Run `just docs` to regenerate
3. Review and commit changes

### Updating Example Documentation

Example `README.md` and `versions.tf` files are generated from templates. To change example documentation:

1. Edit `docs/example_readme.md` template (for README content)
2. Run `just gen-examples` to regenerate all example READMEs and versions.tf files
3. Review and commit changes

The `versions.tf` files are generated by copying the root `versions.tf` and optionally adding provider configuration from `docs/examples.yaml` (`examples_readme.versions_tf.add` setting).

### Adding or Modifying Example Tables

Example tables in the root README are generated from `docs/examples.yaml` configuration:

1. Edit the `tables` section in `docs/examples.yaml`
2. Run `just gen-readme` to regenerate tables
3. Review and commit changes

## Running Documentation Commands

You do not need deep Terraform knowledge to regenerate documentation. Use these commands:

```bash
# Regenerate all documentation
just docs

# Regenerate only root README sections (TOC and tables)
just gen-readme

# Regenerate only example READMEs and versions.tf files
just gen-examples

# Verify documentation is up-to-date
just check-docs
```

### Command Options

Both `gen-readme` and `gen-examples` support additional options:

**`just gen-readme` options:**
- `--dry-run`: Preview changes without modifying files
- `--skip-toc`: Skip updating the Table of Contents section
- `--skip-tables`: Skip updating the example tables section

**`just gen-examples` options:**
- `--dry-run`: Preview changes without modifying files
- `--skip-readme`: Skip generating README.md files
- `--skip-versions`: Skip generating versions.tf files
- `--no-skip`: Process all examples (include examples normally excluded)
- `--version <version>`: Include module version in code snippets (e.g., `--version v1.0.0`)

## Common Workflows

### Adding a New Variable

1. Add variable to `variable_*.tf` with description
2. Optionally add to `docs/inputs_groups.yaml` if it should appear in a specific group
3. Run `just docs`
4. Review generated Inputs section
5. Commit changes

### Updating Variable Descriptions

1. Edit `description` in `variable_*.tf`
2. Run `just docs`
3. Review generated changes
4. Commit

### Changing Example Table Structure

1. Edit `docs/examples.yaml` tables configuration
2. Run `just gen-readme`
3. Review table changes in root README.md
4. Commit

### Fixing Documentation Drift

If documentation is out of sync (detected by CI or `just check-docs`):

1. Run `just docs` to regenerate everything
2. Review `git diff` to see what changed
3. If changes look correct, commit them
4. If changes are unexpected, check:
   - Did you edit a generated section? Revert that edit and update the source instead
   - Did you modify `variable_*.tf`? The changes reflect your edits
   - Did configuration change? Verify `.terraform-docs.yml` or `docs/inputs_groups.yaml`

## Documentation Generation Tools

- **[terraform-docs](https://terraform-docs.io/)**: Generates Requirements, Providers, Resources, Variables, and Outputs sections from Terraform files
- **Python scripts** (`.github/`): Custom scripts for TOC, tables, grouped inputs, and example READMEs

## Questions

- If documentation generation fails, check Python script output for errors
- If generated content looks wrong, verify source files (`variable_*.tf`, configuration files)
- If you need to change generation logic, see scripts in `.github/` directory
